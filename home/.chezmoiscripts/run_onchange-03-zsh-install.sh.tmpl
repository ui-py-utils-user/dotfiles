{{ $sudo := "sudo" -}}
{{ if eq .chezmoi.username "root" -}}
{{     $sudo = "" -}}
{{ end -}}
#! /bin/bash
{{ if (or (eq .chezmoi.os "darwin") (eq .chezmoi.arch "amd64")) }}
{{    if eq .chezmoi.osRelease.idLike "ubuntu debian" -}}
        HOMEBREW_NO_INSTALL_CLEANUP=true brew reinstall zsh
{{    else -}}
        {{ $sudo }} apt install -yy zsh
{{    end -}}
{{ else -}}
      {{ $sudo }} apt install -yy zsh
{{ end -}}

ZSH_AUTO_SUGGESTION_DIR=${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions
if [ ! -d $ZSH_AUTO_SUGGESTION_DIR ]; then
    git clone https://github.com/zsh-users/zsh-autosuggestions $ZSH_AUTO_SUGGESTION_DIR
else
    cd $ZSH_AUTO_SUGGESTION_DIR && git pull
fi

[ "$(basename ${SHELL})" != "zsh" ] && {{ $sudo }} chsh -s $(which zsh) $(id -un)

exit 0

